<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="sleap.nn.heads" href="sleap.nn.heads.html" /><link rel="prev" title="sleap.nn.callbacks" href="sleap.nn.callbacks.html" />

    <link rel="shortcut icon" href="../_static/favicon.ico"/><meta name="generator" content="sphinx-3.5.3, furo 2021.03.20.beta30"/>
        <title>sleap.nn.evals - SLEAP (v1.1.3)</title>
      <link rel="stylesheet" href="../_static/styles/furo.css?digest=978e1795dfe158b585dda6a8417f6411828bf3ed">
    <link rel="stylesheet" href="../_static/pygments.css">
    <link media="(prefers-color-scheme: dark)" rel="stylesheet" href="../_static/pygments_dark.css">
    


<style>
  :root {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  @media (prefers-color-scheme: dark) {
    :root {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }

  /* For allowing end-user-specific overrides */
  .override-light {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  .override-dark {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
</style><link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" href="../_static/styles/furo-extensions.css?digest=d391b54134226e4196576da3bdb6dddb7e05ba2b"></head>
  <body dir="">
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke-width="1.5" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z"/>
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
      class="feather feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
      class="feather feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">SLEAP (v1.1.3)</div></a>
    </div>
    <div class="header-right">
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/logo.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/logo.png" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">SLEAP (v1.1.3)</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html">
  <input class="sidebar-search" placeholder=Search name="q">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Home</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tutorials/tutorial.html">Tutorial</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label for="toctree-checkbox-1"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/new-project.html">Creating a project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/initial-labeling.html">Initial Labeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/initial-training.html">Training and Inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/assisted-labeling.html">Prediction-assisted labeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/assisted-labeling.html#reviewing-and-fixing-predictions">Reviewing and fixing predictions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/proofreading.html">Tracking instances across frames</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials/analysis.html">Export Data For Analysis</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../guides/index.html">Guides</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label for="toctree-checkbox-2"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../guides/gui.html">GUI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/cli.html">Command line interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/skeletons.html">Skeleton design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/choosing-models.html">Choosing a set of models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/merging.html">Importing predictions for labeling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/proofreading.html">Tracking and proofreading</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/colab.html">Run training and inference on Colab</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/custom-training.html">Creating a custom training profile</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/remote.html">Running SLEAP remotely</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../notebooks/index.html">Notebooks</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label for="toctree-checkbox-3"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/Training_and_inference_on_an_example_dataset.html">Training and inference on an example dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/Training_and_inference_using_Google_Drive.html">Training and inference on your own data using Google Drive</a></li>
<li class="toctree-l2"><a class="reference internal" href="../notebooks/Analysis_examples.html">Analysis examples</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../api.html">Developer API</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label for="toctree-checkbox-4"><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="sleap.instance.html">sleap.instance</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.message.html">sleap.message</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.skeleton.html">sleap.skeleton</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.util.html">sleap.util</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.asyncvideo.html">sleap.io.asyncvideo</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.convert.html">sleap.io.convert</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.dataset.html">sleap.io.dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.legacy.html">sleap.io.legacy</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.pathutils.html">sleap.io.pathutils</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.video.html">sleap.io.video</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.videowriter.html">sleap.io.videowriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.visuals.html">sleap.io.visuals</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.adaptor.html">sleap.io.format.adaptor</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.coco.html">sleap.io.format.coco</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.deeplabcut.html">sleap.io.format.deeplabcut</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.deepposekit.html">sleap.io.format.deepposekit</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.dispatch.html">sleap.io.format.dispatch</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.filehandle.html">sleap.io.format.filehandle</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.genericjson.html">sleap.io.format.genericjson</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.hdf5.html">sleap.io.format.hdf5</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.labels_json.html">sleap.io.format.labels_json</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.leap_matlab.html">sleap.io.format.leap_matlab</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.main.html">sleap.io.format.main</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.sleap_analysis.html">sleap.io.format.sleap_analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.io.format.text.html">sleap.io.format.text</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.callbacks.html">sleap.nn.callbacks</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">sleap.nn.evals</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.heads.html">sleap.nn.heads</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.inference.html">sleap.nn.inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.losses.html">sleap.nn.losses</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.model.html">sleap.nn.model</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.monitor.html">sleap.nn.monitor</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.paf_grouping.html">sleap.nn.paf_grouping</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.peak_finding.html">sleap.nn.peak_finding</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.system.html">sleap.nn.system</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.tracking.html">sleap.nn.tracking</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.training.html">sleap.nn.training</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.utils.html">sleap.nn.utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.viz.html">sleap.nn.viz</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.tracker.components.html">sleap.nn.tracker.components</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.tracker.kalman.html">sleap.nn.tracker.kalman</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.config.data.html">sleap.nn.config.data</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.config.model.html">sleap.nn.config.model</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.config.optimization.html">sleap.nn.config.optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.config.outputs.html">sleap.nn.config.outputs</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.config.training_job.html">sleap.nn.config.training_job</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.config.utils.html">sleap.nn.config.utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.architectures.common.html">sleap.nn.architectures.common</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.architectures.encoder_decoder.html">sleap.nn.architectures.encoder_decoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.architectures.hourglass.html">sleap.nn.architectures.hourglass</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.architectures.hrnet.html">sleap.nn.architectures.hrnet</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.architectures.leap.html">sleap.nn.architectures.leap</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.architectures.pretrained_encoders.html">sleap.nn.architectures.pretrained_encoders</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.architectures.resnet.html">sleap.nn.architectures.resnet</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.architectures.unet.html">sleap.nn.architectures.unet</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.architectures.upsampling.html">sleap.nn.architectures.upsampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.augmentation.html">sleap.nn.data.augmentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.confidence_maps.html">sleap.nn.data.confidence_maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.dataset_ops.html">sleap.nn.data.dataset_ops</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.edge_maps.html">sleap.nn.data.edge_maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.general.html">sleap.nn.data.general</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.grouping.html">sleap.nn.data.grouping</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.inference.html">sleap.nn.data.inference</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.instance_centroids.html">sleap.nn.data.instance_centroids</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.instance_cropping.html">sleap.nn.data.instance_cropping</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.normalization.html">sleap.nn.data.normalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.offset_regression.html">sleap.nn.data.offset_regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.pipelines.html">sleap.nn.data.pipelines</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.providers.html">sleap.nn.data.providers</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.resizing.html">sleap.nn.data.resizing</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.training.html">sleap.nn.data.training</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.nn.data.utils.html">sleap.nn.data.utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.info.align.html">sleap.info.align</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.info.feature_suggestions.html">sleap.info.feature_suggestions</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.info.labels.html">sleap.info.labels</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.info.metrics.html">sleap.info.metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.info.summary.html">sleap.info.summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.info.trackcleaner.html">sleap.info.trackcleaner</a></li>
<li class="toctree-l2"><a class="reference internal" href="sleap.info.write_tracking_h5.html">sleap.info.write_tracking_h5</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/murthylab/sleap-datasets">Sample datasets</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/murthylab/sleap">Source code</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/murthylab/sleap/releases">Releases</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <main class="main">
    <div class="content">
      <article role="main">
        <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
          <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
        </label>
        <div class="section" id="module-sleap.nn.evals">
<span id="sleap-nn-evals"></span><h1>sleap.nn.evals<a class="headerlink" href="#module-sleap.nn.evals" title="Permalink to this headline">¶</a></h1>
<p>Evaluation utilities for measuring pose estimation accuracy.</p>
<p>To generate metrics, you’ll need two <code class="xref py py-obj docutils literal notranslate"><span class="pre">Labels</span></code> datasets, one with ground truth
data and one with predicted data. The video paths in the datasets must match.
Load both datasets and call <a class="reference internal" href="#sleap.nn.evals.evaluate" title="sleap.nn.evals.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a>, like so:</p>
<p>&gt; labels_gt = Labels.load_file(“path/to/ground/truth.slp”)
&gt; labels_pr = Labels.load_file(“path/to/predictions.slp”)
&gt; metrics = evaluate(labels_gt, labels_pr)</p>
<p><a class="reference internal" href="#sleap.nn.evals.evaluate" title="sleap.nn.evals.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a> returns a dictionary, keys are strings which name the metric,
values are either floats or numpy arrays.</p>
<p>A good place to start if you want to understand how well your models are
performing is to look at:</p>
<blockquote>
<div><ul class="simple">
<li><p>oks_voc.mAP</p></li>
<li><p>vis.precision</p></li>
<li><p>vis.recall</p></li>
<li><p>dist.p95</p></li>
</ul>
</div></blockquote>
<dl class="py function">
<dt id="sleap.nn.evals.compute_dist_metrics">
<code class="sig-prename descclassname"><span class="pre">sleap.nn.evals.</span></code><code class="sig-name descname"><span class="pre">compute_dist_metrics</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dists</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> → <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><a class="reference external" href="https://github.com/murthylab/sleap/blob/v1.1.3/sleap/nn/evals.py#L491-L516"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.evals.compute_dist_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the Euclidean distance error at different percentiles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dists</strong> – An array of pairwise distances of shape <code class="xref py py-obj docutils literal notranslate"><span class="pre">(n_positive_pairs,</span> <span class="pre">n_nodes)</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary of distance metrics.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="sleap.nn.evals.compute_dists">
<code class="sig-prename descclassname"><span class="pre">sleap.nn.evals.</span></code><code class="sig-name descname"><span class="pre">compute_dists</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positive_pairs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sleap.instance.html#sleap.instance.Instance" title="sleap.instance.Instance"><span class="pre">sleap.instance.Instance</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="sleap.instance.html#sleap.instance.PredictedInstance" title="sleap.instance.PredictedInstance"><span class="pre">sleap.instance.PredictedInstance</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> → <span class="pre">numpy.ndarray</span><a class="reference external" href="https://github.com/murthylab/sleap/blob/v1.1.3/sleap/nn/evals.py#L468-L488"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.evals.compute_dists" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute Euclidean distances between matched pairs of instances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>positive_pairs</strong> – A list of tuples of the form <code class="xref py py-obj docutils literal notranslate"><span class="pre">(instance_gt,</span> <span class="pre">instance_pr,</span> <span class="pre">_)</span></code>
containing the matched pair of instances.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An array of pairwise distances of shape <code class="xref py py-obj docutils literal notranslate"><span class="pre">(n_positive_pairs,</span> <span class="pre">n_nodes)</span></code>.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="sleap.nn.evals.compute_generalized_voc_metrics">
<code class="sig-prename descclassname"><span class="pre">sleap.nn.evals.</span></code><code class="sig-name descname"><span class="pre">compute_generalized_voc_metrics</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positive_pairs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sleap.instance.html#sleap.instance.Instance" title="sleap.instance.Instance"><span class="pre">sleap.instance.Instance</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="sleap.instance.html#sleap.instance.PredictedInstance" title="sleap.instance.PredictedInstance"><span class="pre">sleap.instance.PredictedInstance</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">false_negatives</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sleap.instance.html#sleap.instance.Instance" title="sleap.instance.Instance"><span class="pre">sleap.instance.Instance</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_scores</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_score_thresholds</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">array([0.5,</span> <span class="pre">0.55,</span> <span class="pre">0.6,</span> <span class="pre">0.65,</span> <span class="pre">0.7,</span> <span class="pre">0.75,</span> <span class="pre">0.8,</span> <span class="pre">0.85,</span> <span class="pre">0.9,</span> <span class="pre">0.95])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recall_thresholds</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">array([0.0,</span> <span class="pre">0.01,</span> <span class="pre">0.02,</span> <span class="pre">0.03,</span> <span class="pre">0.04,</span> <span class="pre">0.05,</span> <span class="pre">0.06,</span> <span class="pre">0.07,</span> <span class="pre">0.08,</span> <span class="pre">0.09,</span> <span class="pre">0.1,</span> <span class="pre">0.11,</span> <span class="pre">0.12,</span> <span class="pre">0.13,</span> <span class="pre">0.14,</span> <span class="pre">0.15,</span> <span class="pre">0.16,</span> <span class="pre">0.17,</span> <span class="pre">0.18,</span> <span class="pre">0.19,</span> <span class="pre">0.2,</span> <span class="pre">0.21,</span> <span class="pre">0.22,</span> <span class="pre">0.23,</span> <span class="pre">0.24,</span> <span class="pre">0.25,</span> <span class="pre">0.26,</span> <span class="pre">0.27,</span> <span class="pre">0.28,</span> <span class="pre">0.29,</span> <span class="pre">0.3,</span> <span class="pre">0.31,</span> <span class="pre">0.32,</span> <span class="pre">0.33,</span> <span class="pre">0.34,</span> <span class="pre">0.35,</span> <span class="pre">0.36,</span> <span class="pre">0.37,</span> <span class="pre">0.38,</span> <span class="pre">0.39,</span> <span class="pre">0.4,</span> <span class="pre">0.41,</span> <span class="pre">0.42,</span> <span class="pre">0.43,</span> <span class="pre">0.44,</span> <span class="pre">0.45,</span> <span class="pre">0.46,</span> <span class="pre">0.47,</span> <span class="pre">0.48,</span> <span class="pre">0.49,</span> <span class="pre">0.5,</span> <span class="pre">0.51,</span> <span class="pre">0.52,</span> <span class="pre">0.53,</span> <span class="pre">0.54,</span> <span class="pre">0.55,</span> <span class="pre">0.56,</span> <span class="pre">0.57,</span> <span class="pre">0.58,</span> <span class="pre">0.59,</span> <span class="pre">0.6,</span> <span class="pre">0.61,</span> <span class="pre">0.62,</span> <span class="pre">0.63,</span> <span class="pre">0.64,</span> <span class="pre">0.65,</span> <span class="pre">0.66,</span> <span class="pre">0.67,</span> <span class="pre">0.68,</span> <span class="pre">0.69,</span> <span class="pre">0.7,</span> <span class="pre">0.71,</span> <span class="pre">0.72,</span> <span class="pre">0.73,</span> <span class="pre">0.74,</span> <span class="pre">0.75,</span> <span class="pre">0.76,</span> <span class="pre">0.77,</span> <span class="pre">0.78,</span> <span class="pre">0.79,</span> <span class="pre">0.8,</span> <span class="pre">0.81,</span> <span class="pre">0.82,</span> <span class="pre">0.83,</span> <span class="pre">0.84,</span> <span class="pre">0.85,</span> <span class="pre">0.86,</span> <span class="pre">0.87,</span> <span class="pre">0.88,</span> <span class="pre">0.89,</span> <span class="pre">0.9,</span> <span class="pre">0.91,</span> <span class="pre">0.92,</span> <span class="pre">0.93,</span> <span class="pre">0.94,</span> <span class="pre">0.95,</span> <span class="pre">0.96,</span> <span class="pre">0.97,</span> <span class="pre">0.98,</span> <span class="pre">0.99,</span> <span class="pre">1.0])</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'gvoc'</span></span></em><span class="sig-paren">)</span> → <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><a class="reference external" href="https://github.com/murthylab/sleap/blob/v1.1.3/sleap/nn/evals.py#L385-L465"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.evals.compute_generalized_voc_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute VOC metrics given matched pairs of instances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>positive_pairs</strong> – A list of tuples of the form <code class="xref py py-obj docutils literal notranslate"><span class="pre">(instance_gt,</span> <span class="pre">instance_pr,</span> <span class="pre">_)</span></code>
containing the matched pair of instances.</p></li>
<li><p><strong>false_negatives</strong> – A list of unmatched instances.</p></li>
<li><p><strong>match_scores</strong> – The score obtained in the matching procedure for each matched pair
(e.g., OKS).</p></li>
<li><p><strong>match_score_thresholds</strong> – Score thresholds at which to consider matches as a true
positive match.</p></li>
<li><p><strong>recall_thresholds</strong> – Recall thresholds at which to evaluate Average Precision.</p></li>
<li><p><strong>name</strong> – Name to use to prefix returned metric keys.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary of VOC metrics.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="sleap.nn.evals.compute_instance_area">
<code class="sig-prename descclassname"><span class="pre">sleap.nn.evals.</span></code><code class="sig-name descname"><span class="pre">compute_instance_area</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> → <span class="pre">numpy.ndarray</span><a class="reference external" href="https://github.com/murthylab/sleap/blob/v1.1.3/sleap/nn/evals.py#L112-L127"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.evals.compute_instance_area" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the area of the bounding box of a set of keypoints.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>points</strong> – A numpy array of coordinates.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The area of the bounding box of the points.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="sleap.nn.evals.compute_oks">
<code class="sig-prename descclassname"><span class="pre">sleap.nn.evals.</span></code><code class="sig-name descname"><span class="pre">compute_oks</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">points_gt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">points_pr</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stddev</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.025</span></span></em><span class="sig-paren">)</span> → <span class="pre">numpy.ndarray</span><a class="reference external" href="https://github.com/murthylab/sleap/blob/v1.1.3/sleap/nn/evals.py#L130-L233"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.evals.compute_oks" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the object keypoints similarity between sets of points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>points_gt</strong> – Ground truth instances of shape (n_gt, n_nodes, n_ed),
where n_nodes is the number of body parts/keypoint types, and n_ed
is the number of Euclidean dimensions (typically 2 or 3). Keypoints
that are missing/not visible should be represented as NaNs.</p></li>
<li><p><strong>points_pr</strong> – Predicted instance of shape (n_pr, n_nodes, n_ed).</p></li>
<li><p><strong>scale</strong> – Size scaling factor to use when weighing the scores, typically
the area of the bounding box of the instance (in pixels). This
should be of the length n_gt. If a scalar is provided, the same
number is used for all ground truth instances. If set to None, the
bounding box area of the ground truth instances will be calculated.</p></li>
<li><p><strong>stddev</strong> – The standard deviation associated with the spread in the
localization accuracy of each node/keypoint type. This should be of
the length n_nodes. “Easier” keypoint types will have lower values
to reflect the smaller spread expected in localizing it.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The object keypoints similarity between every pair of ground truth and
predicted instance, a numpy array of of shape (n_gt, n_pr) in the range
of [0, 1.0], with 1.0 denoting a perfect match.</p>
</dd>
</dl>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>It’s important to set the stddev appropriately when accounting for the
difficulty of each keypoint type. For reference, the median value for
all keypoint types in COCO is 0.072. The “easiest” keypoint is the left
eye, with stddev of 0.025, since it is easy to precisely locate the
eyes when labeling. The “hardest” keypoint is the left hip, with stddev
of 0.107, since it’s hard to locate the left hip bone without external
anatomical features and since it is often occluded by clothing.</p>
<p>The implementation here is based off of the descriptions in:
Ronch &amp; Perona. “Benchmarking and Error Diagnosis in Multi-Instance Pose
Estimation.” ICCV (2017).</p>
</div>
</dd></dl>
<dl class="py function">
<dt id="sleap.nn.evals.compute_pck_metrics">
<code class="sig-prename descclassname"><span class="pre">sleap.nn.evals.</span></code><code class="sig-name descname"><span class="pre">compute_pck_metrics</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dists</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresholds</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">numpy.ndarray</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">array([1.0,</span> <span class="pre">2.0,</span> <span class="pre">3.0,</span> <span class="pre">4.0,</span> <span class="pre">5.0,</span> <span class="pre">6.0,</span> <span class="pre">7.0,</span> <span class="pre">8.0,</span> <span class="pre">9.0,</span> <span class="pre">10.0])</span></span></em><span class="sig-paren">)</span> → <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><a class="reference external" href="https://github.com/murthylab/sleap/blob/v1.1.3/sleap/nn/evals.py#L519-L542"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.evals.compute_pck_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute PCK across a range of thresholds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dists</strong> – An array of pairwise distances of shape <code class="xref py py-obj docutils literal notranslate"><span class="pre">(n_positive_pairs,</span> <span class="pre">n_nodes)</span></code>.</p></li>
<li><p><strong>thresholds</strong> – A list of distance thresholds in pixels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary of PCK metrics evaluated at each threshold.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="sleap.nn.evals.compute_visibility_conf">
<code class="sig-prename descclassname"><span class="pre">sleap.nn.evals.</span></code><code class="sig-name descname"><span class="pre">compute_visibility_conf</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">positive_pairs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sleap.instance.html#sleap.instance.Instance" title="sleap.instance.Instance"><span class="pre">sleap.instance.Instance</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="sleap.instance.html#sleap.instance.Instance" title="sleap.instance.Instance"><span class="pre">sleap.instance.Instance</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> → <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><a class="reference external" href="https://github.com/murthylab/sleap/blob/v1.1.3/sleap/nn/evals.py#L545-L578"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.evals.compute_visibility_conf" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute node visibility metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>positive_pairs</strong> – A list of tuples of the form <code class="xref py py-obj docutils literal notranslate"><span class="pre">(instance_gt,</span> <span class="pre">instance_pr,</span> <span class="pre">_)</span></code>
containing the matched pair of instances.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A dictionary of visibility metrics, including the confusion matrix.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="sleap.nn.evals.evaluate">
<code class="sig-prename descclassname"><span class="pre">sleap.nn.evals.</span></code><code class="sig-name descname"><span class="pre">evaluate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels_gt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="sleap.io.dataset.html#sleap.io.dataset.Labels" title="sleap.io.dataset.Labels"><span class="pre">sleap.io.dataset.Labels</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_pr</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="sleap.io.dataset.html#sleap.io.dataset.Labels" title="sleap.io.dataset.Labels"><span class="pre">sleap.io.dataset.Labels</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">oks_stddev</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.025</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">oks_scale</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match_threshold</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_labels_only</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> → <span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><a class="reference external" href="https://github.com/murthylab/sleap/blob/v1.1.3/sleap/nn/evals.py#L581-L643"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.evals.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate all metrics from ground truth and predicted labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels_gt</strong> – The <code class="xref py py-obj docutils literal notranslate"><span class="pre">Labels</span></code> dataset object with ground truth labels.</p></li>
<li><p><strong>labels_pr</strong> – The <code class="xref py py-obj docutils literal notranslate"><span class="pre">Labels</span></code> dataset object with predicted labels.</p></li>
<li><p><strong>oks_stddev</strong> – The standard deviation to use for calculating object
keypoint similarity; see <a class="reference internal" href="#sleap.nn.evals.compute_oks" title="sleap.nn.evals.compute_oks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_oks</span></code></a> function for details.</p></li>
<li><p><strong>oks_scale</strong> – The scale to use for calculating object
keypoint similarity; see <a class="reference internal" href="#sleap.nn.evals.compute_oks" title="sleap.nn.evals.compute_oks"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compute_oks</span></code></a> function for details.</p></li>
<li><p><strong>match_threshold</strong> – The threshold to use on oks scores when determining
which instances match between ground truth and predicted frames.</p></li>
<li><p><strong>user_labels_only</strong> – If False, predicted instances in the ground truth frame may be
considered for matching.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dict, keys are strings, values are metrics (floats or ndarrays).</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="sleap.nn.evals.evaluate_model">
<code class="sig-prename descclassname"><span class="pre">sleap.nn.evals.</span></code><code class="sig-name descname"><span class="pre">evaluate_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="sleap.nn.config.training_job.html#sleap.nn.config.training_job.TrainingJobConfig" title="sleap.nn.config.training_job.TrainingJobConfig"><span class="pre">sleap.nn.config.training_job.TrainingJobConfig</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_reader</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="sleap.nn.data.providers.html#sleap.nn.data.providers.LabelsReader" title="sleap.nn.data.providers.LabelsReader"><span class="pre">sleap.nn.data.providers.LabelsReader</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="sleap.nn.model.html#sleap.nn.model.Model" title="sleap.nn.model.Model"><span class="pre">sleap.nn.model.Model</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">split_name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'test'</span></span></em><span class="sig-paren">)</span> → <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sleap.io.dataset.html#sleap.io.dataset.Labels" title="sleap.io.dataset.Labels"><span class="pre">sleap.io.dataset.Labels</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><a class="reference external" href="https://github.com/murthylab/sleap/blob/v1.1.3/sleap/nn/evals.py#L646-L726"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.evals.evaluate_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate a trained model and save metrics and predictions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> – The <code class="xref py py-obj docutils literal notranslate"><span class="pre">TrainingJobConfig</span></code> associated with the model.</p></li>
<li><p><strong>labels_reader</strong> – A <code class="xref py py-obj docutils literal notranslate"><span class="pre">LabelsReader</span></code> pipeline generator that reads the ground truth
data to evaluate.</p></li>
<li><p><strong>model</strong> – The <a class="reference internal" href="sleap.nn.model.html#sleap.nn.model.Model" title="sleap.nn.model.Model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sleap.nn.model.Model</span></code></a> instance to evaluate.</p></li>
<li><p><strong>save</strong> – If True, save the predictions and metrics to the model folder.</p></li>
<li><p><strong>split_name</strong> – String name to append to the saved filenames.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>A tuple of <code class="xref py py-obj docutils literal notranslate"><span class="pre">(labels_pr,</span> <span class="pre">metrics)</span></code>.</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">labels_pr</span></code> will contain the predicted labels.</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">metrics</span></code> will contain the evaluated metrics given the predictions, or None if
the metrics failed to be computed.</p>
</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="sleap.nn.evals.find_frame_pairs">
<code class="sig-prename descclassname"><span class="pre">sleap.nn.evals.</span></code><code class="sig-name descname"><span class="pre">find_frame_pairs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">labels_gt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="sleap.io.dataset.html#sleap.io.dataset.Labels" title="sleap.io.dataset.Labels"><span class="pre">sleap.io.dataset.Labels</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels_pr</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="sleap.io.dataset.html#sleap.io.dataset.Labels" title="sleap.io.dataset.Labels"><span class="pre">sleap.io.dataset.Labels</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_labels_only</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> → <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sleap.instance.html#sleap.instance.LabeledFrame" title="sleap.instance.LabeledFrame"><span class="pre">sleap.instance.LabeledFrame</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="sleap.instance.html#sleap.instance.LabeledFrame" title="sleap.instance.LabeledFrame"><span class="pre">sleap.instance.LabeledFrame</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><a class="reference external" href="https://github.com/murthylab/sleap/blob/v1.1.3/sleap/nn/evals.py#L57-L109"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.evals.find_frame_pairs" title="Permalink to this definition">¶</a></dt>
<dd><p>Find corresponding frames across two sets of labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>labels_gt</strong> – A <code class="xref py py-obj docutils literal notranslate"><span class="pre">sleap.Labels</span></code> instance with ground truth instances.</p></li>
<li><p><strong>labels_pr</strong> – A <code class="xref py py-obj docutils literal notranslate"><span class="pre">sleap.Labels</span></code> instance with predicted instances.</p></li>
<li><p><strong>user_labels_only</strong> – If False, frames with predicted instances in <code class="xref py py-obj docutils literal notranslate"><span class="pre">labels_gt</span></code> will
also be considered for matching.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of pairs of <code class="xref py py-obj docutils literal notranslate"><span class="pre">sleap.LabeledFrame`s</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">form</span> <span class="pre">`(frame_gt,</span> <span class="pre">frame_pr)</span></code>.</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="sleap.nn.evals.match_frame_pairs">
<code class="sig-prename descclassname"><span class="pre">sleap.nn.evals.</span></code><code class="sig-name descname"><span class="pre">match_frame_pairs</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame_pairs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sleap.instance.html#sleap.instance.LabeledFrame" title="sleap.instance.LabeledFrame"><span class="pre">sleap.instance.LabeledFrame</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="sleap.instance.html#sleap.instance.LabeledFrame" title="sleap.instance.LabeledFrame"><span class="pre">sleap.instance.LabeledFrame</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stddev</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.025</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_labels_only</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> → <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sleap.instance.html#sleap.instance.Instance" title="sleap.instance.Instance"><span class="pre">sleap.instance.Instance</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="sleap.instance.html#sleap.instance.PredictedInstance" title="sleap.instance.PredictedInstance"><span class="pre">sleap.instance.PredictedInstance</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sleap.instance.html#sleap.instance.Instance" title="sleap.instance.Instance"><span class="pre">sleap.instance.Instance</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><a class="reference external" href="https://github.com/murthylab/sleap/blob/v1.1.3/sleap/nn/evals.py#L336-L382"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.evals.match_frame_pairs" title="Permalink to this definition">¶</a></dt>
<dd><p>Match all ground truth and predicted instances within each pair of frames.</p>
<p>This is a wrapper for <a class="reference internal" href="#sleap.nn.evals.match_instances" title="sleap.nn.evals.match_instances"><code class="xref py py-obj docutils literal notranslate"><span class="pre">match_instances()</span></code></a> but operates on lists of frames.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frame_pairs</strong> – A list of pairs of <code class="xref py py-obj docutils literal notranslate"><span class="pre">sleap.LabeledFrame`s</span> <span class="pre">in</span> <span class="pre">the</span> <span class="pre">form</span>
<span class="pre">`(frame_gt,</span> <span class="pre">frame_pr)</span></code>. These can be obtained with <a class="reference internal" href="#sleap.nn.evals.find_frame_pairs" title="sleap.nn.evals.find_frame_pairs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">find_frame_pairs()</span></code></a>.</p></li>
<li><p><strong>stddev</strong> – The expected spread of coordinates for OKS computation.</p></li>
<li><p><strong>scale</strong> – The scale for normalizing the OKS. If not set, the bounding box area will
be used.</p></li>
<li><p><strong>threshold</strong> – The minimum OKS between a candidate pair of instances to be
considered a match.</p></li>
<li><p><strong>user_labels_only</strong> – If False, predicted instances in the ground truth frame may be
considered for matching.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>A tuple of (<code class="xref py py-obj docutils literal notranslate"><span class="pre">positive_pairs</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">false_negatives</span></code>).</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">positive_pairs</span></code> is a list of 3-tuples of the form
<code class="xref py py-obj docutils literal notranslate"><span class="pre">(instance_gt,</span> <span class="pre">instance_pr,</span> <span class="pre">oks)</span></code> containing the matched pair of instances and
their OKS.</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">false_negatives</span></code> is a list of ground truth <a href="#id1"><span class="problematic" id="id2">`</span></a>sleap.Instance`s that could not be
matched.</p>
</p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt id="sleap.nn.evals.match_instances">
<code class="sig-prename descclassname"><span class="pre">sleap.nn.evals.</span></code><code class="sig-name descname"><span class="pre">match_instances</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame_gt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="sleap.instance.html#sleap.instance.LabeledFrame" title="sleap.instance.LabeledFrame"><span class="pre">sleap.instance.LabeledFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_pr</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="sleap.instance.html#sleap.instance.LabeledFrame" title="sleap.instance.LabeledFrame"><span class="pre">sleap.instance.LabeledFrame</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">stddev</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.025</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_labels_only</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span> → <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sleap.instance.html#sleap.instance.Instance" title="sleap.instance.Instance"><span class="pre">sleap.instance.Instance</span></a><span class="p"><span class="pre">,</span> </span><a class="reference internal" href="sleap.instance.html#sleap.instance.PredictedInstance" title="sleap.instance.PredictedInstance"><span class="pre">sleap.instance.PredictedInstance</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="sleap.instance.html#sleap.instance.Instance" title="sleap.instance.Instance"><span class="pre">sleap.instance.Instance</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><a class="reference external" href="https://github.com/murthylab/sleap/blob/v1.1.3/sleap/nn/evals.py#L236-L333"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.evals.match_instances" title="Permalink to this definition">¶</a></dt>
<dd><p>Match pairs of instances between ground truth and predictions in a frame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frame_gt</strong> – A <code class="xref py py-obj docutils literal notranslate"><span class="pre">sleap.LabeledFrame</span></code> with ground truth instances.</p></li>
<li><p><strong>frame_pr</strong> – A <code class="xref py py-obj docutils literal notranslate"><span class="pre">sleap.LabeledFrame</span></code> with predicted instances.</p></li>
<li><p><strong>stddev</strong> – The expected spread of coordinates for OKS computation.</p></li>
<li><p><strong>scale</strong> – The scale for normalizing the OKS. If not set, the bounding box area will
be used.</p></li>
<li><p><strong>threshold</strong> – The minimum OKS between a candidate pair of instances to be
considered a match.</p></li>
<li><p><strong>user_labels_only</strong> – If False, predicted instances in the ground truth frame may be
considered for matching.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>A tuple of (<code class="xref py py-obj docutils literal notranslate"><span class="pre">positive_pairs</span></code>, <code class="xref py py-obj docutils literal notranslate"><span class="pre">false_negatives</span></code>).</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">positive_pairs</span></code> is a list of 3-tuples of the form
<code class="xref py py-obj docutils literal notranslate"><span class="pre">(instance_gt,</span> <span class="pre">instance_pr,</span> <span class="pre">oks)</span></code> containing the matched pair of instances and
their OKS.</p>
<p><code class="xref py py-obj docutils literal notranslate"><span class="pre">false_negatives</span></code> is a list of ground truth <a href="#id3"><span class="problematic" id="id4">`</span></a>sleap.Instance`s that could not be
matched.</p>
</p>
</dd>
</dl>
<div class="admonition-notes admonition">
<p class="admonition-title">Notes</p>
<p>This function uses the approach from the PASCAL VOC scoring procedure. Briefly,
predictions are sorted descending by their instance-level prediction scores and
greedily matched to ground truth instances which are then removed from the pool
of available instances.</p>
<p>Ground truth instances that remain unmatched are considered false negatives.</p>
</div>
</dd></dl>
<dl class="py function">
<dt id="sleap.nn.evals.replace_path">
<code class="sig-prename descclassname"><span class="pre">sleap.nn.evals.</span></code><code class="sig-name descname"><span class="pre">replace_path</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">video_list</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_paths</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/murthylab/sleap/blob/v1.1.3/sleap/nn/evals.py#L48-L54"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sleap.nn.evals.replace_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace video paths in unstructured video objects.</p>
</dd></dl>
</div>

      </article>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="sleap.nn.heads.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">sleap.nn.heads</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="sleap.nn.callbacks.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">sleap.nn.callbacks</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; 2019–2021, Murthy Lab @ Princeton University
            |
            Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
              and
              <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
              <a href="https://github.com/pradyunsg/furo">Furo theme</a>.
            |
            <a class="muted-link" href="../_sources/api/sleap.nn.evals.rst.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </main>
</div>
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/scripts/main.js?digest=e931d09b2a40c1bb82b542effe772014573baf67"></script></body>
</html>